# UsedItsue-Trend 프로젝트 소개

- 아무 사이트의 주소를 입력 받아 웹 크롤링(파이썬 파일)을 진행한 후, 가장 많이 등장한 명사, 동사, 형용사 50개를 추출해 워드 클라우드와 그래프로 시각화하는 프로그램
- 오늘의 데이터: 워드 클라우드 + 파이 그래프
- 주간 데이터: 워드 클라우드 + 꺾은 선 그래프 (범위 - 지금으로부터 6일 전 ~ 오늘)
- 월간 데이터: 워드 클라우드 + 꺾은 선 그래프 (범위 - 이번 달 1일 ~ 오늘)

# 역할 분담

**오다은**

1. 주간, 월간 꺾은 선 그래프 구현 (날짜 지정)
   - etc.html, weekly.js, monthly.js
   - TrendInfoService의 getDailyKeywords 함수
2. 검색한 사이트 데이터만 추출
3. 데이터 자동 생성 (+ 기존 url들 가져와서 실행 시 현재 시각 기준으로 데이터 생성 -> 기능 보완)

- (+) 각종 오류 수정
  - 워드 클라우드 안 뜨는 거 (attribute name 불일치, 데이터 없거나 웹크롤링이 불가한 사이트)
  - 조원들 코드 main으로 merge했을 때 뜨는 오류들

**김송미**

1. 주소를 입력 받아 웹 크롤링을 진행한 후, 가장 많이 등장한 명사, 동사, 형용사 50개를 추출해 워드 클라우드 생성 및 데이터 추출 (파이썬 코드)
2. 주간/월간 데이터 합쳐서 1개의 워드 클라우드 생성 (파이썬 코드)

**최상준**

1. 주간, 월간 조회버튼 추가
2. 오늘 날짜 트랜드 조회
   - ~~주소 입력 받고 해당 주소의 데이터가 없으면 새로 생성~~ -> 로직 수정됨

**김용준**

1. 오류수정
   - 기초 설정 및 가상환경 재정의
2. 스타일 기획 및 설정
   - 색상 테마 설정
   - wc이미지 위치 등 레이아웃 설정
3. 파일 트리 설계
   - 각 js파일 분기
   - html 설정

# 기능 설명

## url 입력

### daily

- 주소 입력 시 웹크롤링 후 db기록에 있는 해당 사이트에 대한 오늘의 모든 데이터를 가져 옴
- 워드클라우드는 가져온 데이터를 통합해 생성
- 파이 차트는 기존 etc.js 코드 이용

### weekly

- 주소 입력 시 웹크롤링 후 db기록에 있는 해당 사이트에 대한 6일 전 ~ 오늘 범위의 데이터를 가져옴
- 워드클라우드는 가져온 데이터를 통합해 생성
- 꺾은 선 그래프는 데이터를 딕셔너리({"날짜": {"키워드": 빈도수, ...}, ...}) 형태의 json으로 받아와 처리

### monthly

- 주소 입력 시 웹크롤링 후 db기록에 있는 해당 사이트에 대한 해당 월의 1일 ~ 오늘 범위의 데이터를 가져옴
- 워드클라우드는 가져온 데이터를 통합해 생성
- 꺾은 선 그래프는 데이터를 딕셔너리({"날짜": {"키워드": 빈도수, ...}, ...}) 형태의 json으로 받아와 처리

## 주간/월간 화면 분기

- 버튼으로 화면 분기
- display = "none", display = "block"으로 치환하는 방식

# UsedItsue-Product 프로젝트 소개

- 상품의 추가/검색/수정/삭제(CRUD) 기능 구현

# 역할 분담

**오다은**

1. 상품 정보 수정/삭제 기능 구현 (DB에서의 삭제 X, 삭제 일시만 업데이트)
   - `ProductUpdateService`의 `processBatch()`
      - HttpServletRequest의 method가 DELETE인지 PATCH인지 판단 (대소문자 구분 안 함)
      - DELETE: 삭제 일시 업데이트
      - PATCH: 상품 수정 일시 업데이트, ~~"cancelDelete_?"가 true면 삭제 일시를 null로 변환~~
   - `common.js`의 공통 양식 처리
      - 수정, 삭제 버튼을 받아와 클릭 이벤트 처리
      - method 지정 (DELETE, PATCH)
      - 바로 수정/삭제하지 않고, alert를 띄움 (근데 alert에서 '예' 버튼을 안 눌러도 수정 일시가 업데이트되는 버그 존재...)
2. 상품 체크박스 양방향 연동 (전체 선택 <-> 개별 선택)
   - `common.js`의 전체 토글 기능 처리
      - 전체선택 체크박스, 하위 체크박스들 불러옴
      - 전체선택 체크박스 change 이벤트로 판단: 전체선택이 checked=true 되어 있으면 모든 하위 체크박스도 checked=true, false면 false
      - 각 하위 체크박스에서도 change 이벤트를 붙여, 민감하게 작용하도록 함. -> 모든 하위 항목이 checked=true되면 전체선택도 true, 하나라도 false면 전체선택 false

**김송미**

1. 상품의 판매 상태를 `<select>` 방식으로 변경하는 기능 구현
   - `list.html`
      - `<option>` 태그에서 `ProductStatus` enum 목록 반복 출력
   - `ProductController`의 `updateStatus()`
      - `/`, `/list`로 들어오는 PATCH 요청 처리
      - 선택된 항목이 없을 경우, alert 후 history.back()으로 이전 페이지 이동
      - 체크된 인덱스를 받아 와 선택된 판매 상태를 추출, 유효한 값이면 리스트에 추가
      - `ProductUpdateService`의 `updateStatus(...)`에서 DB 업데이트
      - common.js에서 부모 창 새로고침
   - `ProductUpdateService`의 `updateStatus()`
      - 변경될 상품들의 id를 기준으로 DB에서 데이터를 조회
      - 넘겨 받은 판매 상태 리스트로 해당 데이터의 상태를 재설정(setStatus)
   - `common.js`의 판매 상태 토글
      - 사용자가 드롭다운 변경 시, 해당 상품의 체크박스가 자동 선택

**최상준**

1. 검색의 상품 상태 체크박스 전체 선택 기능 구현 (JavaScript + Spring MVC 연동)
   - `ProductAll` enum
      - ALL 하나를 가지고 있다
      - 원래 기존 ProductStatus enum에 ALL을 넣었으나, 문제가 생겨 해결하는 과정에서 ProductAll enum을 추가한 것
      - 개별 판매상태 체크박스의 `<span>` 코드를 참고해 코딩하기 위해 enum으로 추가
   - `common.js`
      - 검색창 내의 전체 선택 체크박스와 개별 상태 체크박스 두 그룹 간의 체크 상태 연동
      - 사용자가 전체 선택 체크박스를 클릭하면 나머지 모든 체크박스의 checked 상태를 같게 설정
      - 개별 체크박스에서 change 이벤트가 발생할 때마다, 모든 개별 체크박스가 체크된 상태면 전체 선택 체크박스를 자동 체크, 하나라도 해제되면 전체선택 체크박스도 해제

**김용준**

1. 스타일 기획 및 설정
   - 색상 테마 설정
   - 전반적인 페이지의 레이아웃 설계
2. 파일 트리 설계
   - 흩어져 있는 **script**와 **css** 각 페이지별로 혹은 용도 별로 정리
3. ProductinfoService 작성
   - 페이징과 의존성 주입 
   - css, js 연결

**안슬기**

1. 이미지 업로드 기능
   - list.html
      - `<img>` 태그로 상품 썸네일 출력 (이미지 경로가 비어 있는 상품은 이모지로 대체)
   - `ProductController`의 `saveProduct()`
      - 제출된 폼에서 이미지를 받아와 경로 설정 후 DB에 저장
   - `ProductFileUploadService`의 `getUploadImagePath()`
      - 이미지 파일과 파일 이름을 받아서 저장할 경로를 생성 및 파일 저장
      - 웹에서 접근 가능한 경로를 반환

**오경석**

1. 조건에 따른 상품 조회 (특히, 검색된 상품 상태에 따른 해당 상태의 상품 조회)
   - `ProductInfoService`의 `getList()`
      - WHERE 조건절을 쌓는 addWhere 문자열 리스트에 `status IN (?, ?, ...)`의 형태를 추가
      - 사용자가 선택한 상품 판매상태(enum) 리스트를 가져와, .name()으로 문자열로 바꿔 파라미터 리스트에 추가
      - 여러 조건을 addWhere에 추가한 후, 최종적으로 sql 쿼리를 조합해 조건에 맞는 실제 데이터를 반환한다

# 기능 설명

## 상품 추가

### 이미지 업로드
- 기존 폼에 '이미지'도 등록할 수 있게 변경
- 상품 추가 폼 제출 시 PRODUCT(DB)에 파일경로+이미지명 저장
- ~~html에 연동하여 상품 썸네일 이미지로 사용~~ -> 경로 문제...

## 상품 검색

- 상품 판매 상태
   - 체크박스로 구현
   - 전체선택 기능 구현
      - 아무것도 선택하지 않아도 전체 검색이 가능하지만, 사용자의 편의성을 고려해 한 번에 선택하고 해제하는 기능을 추가.
- 키워드 검색
   1) 통합 검색: 상품명 + 카테고리
   2) 상품명
   3) 카테고리
   - 아무것도 입력하지 않으면 통합 검색

## 상품 정보 수정

- 판매 상태
   - 토글(select)로 구현
   - 기존과 다른 것을 선택하면, 수정하기를 원하는 것으로 간주하고 체크박스 자동 선택
- 정보 수정 일시 업데이트
   - 수정 일시를 현재 시각으로 설정하고, 현재 페이지를 자동 새로고침

## 상품 삭제

- 정확히는 '등록 해제' 상태로 변경
- DB에서의 삭제가 아니라, 삭제 일시만 변경함
- admin에서 관리하는 목적이라 그렇게 기획함. 추후에 영구 삭제 기능 추가 예정.
- ~~등록 해제 취소~~ -> 됐었는데 이것저것 합치다가 꼬인 듯하다...
